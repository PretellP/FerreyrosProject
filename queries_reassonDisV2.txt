QUERIES:

 ------------------- CREAR TABLA ReasonDissatisfactionV2 ---------------------

CREATE TABLE IF NOT EXISTS pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2
(
  Domain STRING,
  CompanyID STRING,
  CompanyDescription STRING,
  SurveyType STRING,
  BranchOfficeID STRING,
  BranchOfficeDescription STRING,
  SalesOfficeDescription STRING,
  OperationPlace STRING,
  SurveyDate DATE,
  SurveyEndDate DATE,
  CustomerID STRING, 
  CustomerIDDBS STRING, 
  CustomerName STRING,
  CustomerPhomeNumber STRING, 
  InvoiceAmount STRING, 
  ReferenceDocument STRING,
  ModelDescription STRING, 
  FamilyDescription STRING,
  ComponentCode STRING,
  SerialNumber STRING,
  AssignmentReport STRING, 
  SurveyContactName STRING, 
  SurveyContactJobPosition STRING,
  SurveyContactPhoneNumber STRING,
  SurveyContactEmail STRING,
  SurveyPerson STRING,
  SurveyPersonNumber STRING,
  WorkOrderNumber STRING,
  OpeningDate DATE,
  InvoiceDate DATE, 
  TransactionDate DATE,
  LastJobDate DATE,
  WorkOrderClosingDate DATE,
  InvoiceID STRING, 
  ServiceType STRING,
  CSAType STRING,
  WorkshopGroup STRING,
  WorkOrderPrefix STRING,
  CC_CN STRING, 
  WorkOrderPositionType STRING,
  SatisfactionEvaluation INT,
  BuybackEvaluation INT,
  RecommendationEvaluation INT, 
  AttentionEvaluation INT,
  ConfigurationEvaluation INT,
  PerformanceEvaluation INT,
  PhysicalDeliveryEvaluation INT,
  TechnicalDeliveryEvaluation INT, 
  EaseDoingBusinessEvaluation INT,
  AvailabilityEvaluation INT, 
  AnswerEvaluation INT, 
  CommunicationEvaluation INT,
  PreparationEvaluation INT,
  DurationEvaluation INT, 
  TangibleInvoiceEvaluation INT,
  QualityEvaluation INT, 
  InvoicePunctualityEvaluation INT,
  InvoiceAccuracyEvaluation INT, 
  SatisfactionComment STRING,
  BuybackComment STRING,
  RecommendationComment STRING,
  AttentionComment STRING,
  ConfigurationComment STRING,
  PerformanceComment STRING, 
  PhysicalDeliveryComment STRING,
  TechnicalDeliveryComment STRING,
  EaseDoingBusinessComment STRING,
  AvailabilityComment STRING,
  AnswerComment STRING,
  CommunicationComment STRING,
  PreparationComment STRING,
  DurationComment STRING,
  TangibleInvoiceComment STRING,
  QualityComment STRING,
  InvoicePunctualityComment STRING,
  InvoiceAccuracyComment STRING,
  HigherRatingComment STRING,
  AdditionalComment STRING, 
  AudioFile STRING,
  RegionDescription STRING,
  ResponsibleManagement STRING,
  SalesRepGroupDescription STRING,
  CustomerSegmentDescription STRING,
  AditionalCustomerSegmentDescription STRING,
  CustomerMarketDescription STRING,
  RRVV STRING,
  PSSR STRING,
  SurveyCounter INT,
  LoyaltyIndex NUMERIC,
  NetLoyaltyScoreDescription STRING,
  NetLoyaltyScore NUMERIC,
  ExecutedBy STRING,
  CustomerType STRING,
  ParentCustomerName STRING,
  AttendedBy STRING,
  BrandDescription STRING,
  LineDescription STRING,
  CSAPlanType STRING,
  Period STRING,
  UniqueID STRING,
  ReasonDissatisfaction STRING,
  OpportunityImprovement STRING,
  Suggestion STRING, 
);


------------------------------------------------------------------------------------------
DESDE processed_fuentes_diversas HASTA processed_common_data_model.ReasonDissatisfactionv2
------------------------------------------------------------------------------------------



---------------------- CARGA DRIVE ----------------------------

---------- BD_Motivos_Prime ----------

INSERT INTO `pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2` 
    (
    Domain,
    CompanyID,
    CompanyDescription,
    BranchOfficeID,
    BranchOfficeDescription,
    SalesOfficeDescription,
    SurveyDate,
    SurveyEndDate,
    CustomerID,
    CustomerIDDBS,
    CustomerName,
    ModelDescription,
    FamilyDescription,
    SerialNumber,
    AssignmentReport,
    SurveyContactName,
    SurveyContactJobPosition,
    SurveyContactPhoneNumber,
    SurveyContactEmail,
    SatisfactionEvaluation,
    BuybackEvaluation,
    RecommendationEvaluation,
    AttentionEvaluation,
    ConfigurationEvaluation,
    PerformanceEvaluation,
    PhysicalDeliveryEvaluation,
    TechnicalDeliveryEvaluation,
    SatisfactionComment,
    BuybackComment,
    RecommendationComment,
    AttentionComment,
    ConfigurationComment,
    PerformanceComment,
    PhysicalDeliveryComment,
    TechnicalDeliveryComment,
    HigherRatingComment,
    AdditionalComment,
    RegionDescription,
    ResponsibleManagement,
    SalesRepGroupDescription,
    CustomerSegmentDescription,
    AditionalCustomerSegmentDescription,
    CustomerMarketDescription,
    RRVV,
    PSSR,
    SurveyCounter,
    LoyaltyIndex,
    NetLoyaltyScoreDescription,
    NetLoyaltyScore,
    ExecutedBy,
    CustomerType,
    ParentCustomerName,
    AttendedBy,
    BrandDescription,
    LineDescription,
    Period,
    UniqueID,
    ReasonDissatisfaction,
    OpportunityImprovement,
    Suggestion
    ) 
    SELECT 
        'PRIME',
        CASE
            WHEN Organizacion = 'Ferreyros' THEN '2000'
            ELSE NULL
        END,
        Organizacion,
        Nro_Sucursal,
        Sucursal,
        Oficina,
        Mes_encuesta,
        Fecha_finalizacion_encuesta,
        Codigo_Cliente,
        Codigo_Cliente,
        Nombre_Cliente,
        Ind_Modelo,
        Familia_Productos,
        Serie,
        Reporte_Asignacion,
        Contacto_encuesta,
        Cargo,
        Telefono,
        Correo_Electronico,
        Satisfaccion,
        Recompra,
        Recomendacion,
        Atencion,
        Configuracion,
        Desempeno,
        Entrega_Fisica,
        Entrega_tecnica,
        Comentario_Satisfaccion,
        Comentario_Recompra,
        Comentario_Recomendacion,
        Comentario_Atencion,
        Comentario_Configuracion,
        Comentario_Desempeno,
        Comentario_Entrega_Fisica,
        Comentario_Entrega_tecnica,
        Mayor_valoracion,
        Comentario_adicional, 
        Region,
        Gerencia_Responsable,
        Unidad_negocio,
        Segmento, 
        Segmento_2,
        Mercado,
        RRVV,
        PSSR,
        Nro_Encuestas,
        CAST(Indice_lealtad AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        EJECUTADA_POR,
        Tipo_razon_social,
        Razon_social_Parent,
        ATENDIDO_POR,
        MARCA,
        LINEA,
        (concat(SUBSTRING(CAST(MES_ENCUESTA AS STRING), 1, 10))),
        Identificador_unico,
        Motivos_Insatisfaccion,
        Oportunidad_Mejora,
        Sugerencia
    FROM `pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_Motivos_Prime`;


---------- BD_Motivos_Ren ----------

INSERT INTO `pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2` 
    (
    Domain,
    CompanyID,
    CompanyDescription,
    BranchOfficeID,
    BranchOfficeDescription,
    SalesOfficeDescription,
    SurveyDate,
    SurveyEndDate,
    CustomerID,
    CustomerIDDBS,
    CustomerName,
    CustomerPhomeNumber,
    ComponentCode,
    SerialNumber, 
    SurveyContactName,
    SurveyContactPhoneNumber,
    SurveyContactEmail,
    SurveyPerson,
    SurveyPersonNumber,
    SatisfactionEvaluation,
    BuybackEvaluation,
    RecommendationEvaluation,
    EaseDoingBusinessEvaluation,
    AvailabilityEvaluation,
    AnswerEvaluation,
    CommunicationEvaluation,
    PreparationEvaluation,
    DurationEvaluation,
    QualityEvaluation,
    InvoicePunctualityEvaluation,
    InvoiceAccuracyEvaluation,
    SatisfactionComment,
    BuybackComment,
    RecommendationComment,
    EaseDoingBusinessComment,
    AvailabilityComment,
    AnswerComment,
    CommunicationComment,
    PreparationComment,
    DurationComment,
    QualityComment,
    InvoicePunctualityComment,
    InvoiceAccuracyComment,
    HigherRatingComment,
    AdditionalComment,
    AudioFile,
    RegionDescription,
    ResponsibleManagement,
    SalesRepGroupDescription,
    CustomerSegmentDescription,
    AditionalCustomerSegmentDescription,
    CustomerMarketDescription,
    RRVV,
    PSSR,
    SurveyCounter,
    LoyaltyIndex,
    NetLoyaltyScoreDescription,
    NetLoyaltyScore,
    CustomerType,
    ParentCustomerName,
    AttendedBy,
    BrandDescription,
    LineDescription,
    Period,
    ReasonDissatisfaction,
    OpportunityImprovement,
    Suggestion
    ) 
    SELECT 
        'RENTAL',
        CASE
            WHEN Organizacion = 'Ferreyros' THEN '2000'
            ELSE NULL
        END,
        Organizacion,
        Nro_Sucursal,
        Sucursal,
        Oficina,
        Mes_encuesta,
        Fecha_finalizacion_encuesta,
        Numero_Cliente,
        Numero_Cliente,
        Nombre_Cliente,
        Numero_Cliente,
        Codigo_Componente,
        Serie,
        Contacto_Cliente,
        Telefono_Contacto,
        Correo_Contacto,
        Persona_contesto_encuesta,
        Telefono,
        Satisfaccion_General,
        Recompra,
        Recomendacion,
        Facilidad_para_tramite,
        Disponibilidad,
        Respuesta,
        Comunicacion,
        Preparacion,
        Duracion,
        Calidad,
        Puntualidad_factura,
        Precision_factura,
        Satisfaccion_General_Coms,
        Recompra_Coms,
        Recomendacion_Coms,
        Facilidad_para_Tramite_Coms,
        Disponibilidad_Fiabilidad_Coms,
        Respuesta_Coms,
        Comunicacion_Coms,
        Preparacion_Coms,
        Duracion_Coms,
        Calidad_Coms,	
        Puntualidad_Factura_Coms,
        Precision_de_Factura_Coms,
        Mayor_Valoracion_Coms,
        Comentarios_Adicionales, 
        Archivo_audio,
        Region,
        Gerencia_Responsable,
        Unidad_negocio,
        Segmento, 
        Segmento_2,
        Mercado,
        RRVV,
        PSSR,
        Nro_Encuestas,
        CAST(Indice_lealtad AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        Tipo_razon_social,
        Razon_social_Parent,
        ATENDIDO_POR,
        MARCA,
        LINEA,
        (concat(SUBSTRING(CAST(MES_ENCUESTA AS STRING), 1, 10))),
        Motivo_Insatisfaccion,
        Oportunidad_Mejora,
        Sugerencia_Mejora
    FROM `pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_Motivos_Ren`;


---------- BD_Motivos_Rep ----------

INSERT INTO `pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2` 
    (
    Domain,
    CompanyID,
    CompanyDescription,
    SurveyType,
    BranchOfficeID,
    BranchOfficeDescription,
    SalesOfficeDescription,
    SurveyDate,
    SurveyEndDate,
    CustomerID,
    CustomerIDDBS,
    CustomerName,
    InvoiceAmount,
    ReferenceDocument,
    ComponentCode,
    SurveyContactName,
    SurveyContactPhoneNumber,
    SurveyContactEmail,
    SurveyPerson,
    SurveyPersonNumber,
    SatisfactionEvaluation,
    BuybackEvaluation,
    RecommendationEvaluation,
    EaseDoingBusinessEvaluation,
    AvailabilityEvaluation,
    AnswerEvaluation,
    CommunicationEvaluation,
    PreparationEvaluation,
    DurationEvaluation,
    QualityEvaluation,
    InvoicePunctualityEvaluation,
    InvoiceAccuracyEvaluation,
    SatisfactionComment,
    BuybackComment,
    RecommendationComment,
    EaseDoingBusinessComment,
    AvailabilityComment,
    AnswerComment,
    CommunicationComment,
    PreparationComment,
    DurationComment,
    QualityComment,
    InvoicePunctualityComment,
    InvoiceAccuracyComment,
    HigherRatingComment,
    AdditionalComment,
    RegionDescription,
    ResponsibleManagement,
    SalesRepGroupDescription,
    CustomerSegmentDescription,
    AditionalCustomerSegmentDescription,
    CustomerMarketDescription,
    RRVV,
    PSSR,
    SurveyCounter,
    LoyaltyIndex,
    NetLoyaltyScoreDescription,
    NetLoyaltyScore,
    CustomerType,
    ParentCustomerName,
    AttendedBy,
    BrandDescription,
    LineDescription,
    Period,
    ReasonDissatisfaction,
    OpportunityImprovement,
    Suggestion
    ) 
    SELECT 
        'PARTS',
        CASE
        WHEN Organizacion = 'Ferreyros' THEN '2000'
        ELSE NULL
        END,
        ORGANIZACION,
        TIPO_ENCUESTA,
        N_SUCURSAL,
        SUCURSAL,
        OFICINA,
        MES_ENCUESTA,
        FECHA_FINALIZACION_ENCUESTA,
        NUMERO_CLIENTE,
        NUMERO_CLIENTE,
        NOMBRE_CLIENTE,
        MONTO_FACTURADO,
        DOCUMENTO_REFERENCIA,
        CODIGO_COMPONENTE,
        CONTACTO_CLIENTE,
        TELEFONO_CONTACTO,
        CORREO_CONTACTO,
        PERSONA_RESPONDIO_ENCUESTA,
        TELEFONO,
        SATISFACCION_GENERAL,
        RECOMPRA,
        RECOMENDACION,
        FACILIDAD_PARA_TRAMITE,
        DISPONIBILIDAD_CONOCIMIENTO_VENDEDOR,
        RESPUESTA,
        COMUNICACION,
        PREPARACION_STOCK,
        DURACION,
        CALIDAD,
        PUNTUALIDAD_FACTURA,
        PRECISION_FACTURA,
        SATISFACCION_GENERAL_COMENTARIO,
        RECOMPRA_COMENTARIO,
        RECOMENDACION_COMENTARIO,
        FACILIDAD_PARA_TRAMITE_COMENTARIO,
        DISPONIBILIDAD_FIABILIDAD_COMENTARIO,
        RESPUESTA_COMENTARIO,
        COMUNICACION_COMENTARIO,
        PREPARACION_COMS,
        DURACION_COMENTARIO,
        CALIDAD_COMENTARIO,
        PUNTUALIDAD_FACTURA_COMENTARIO,
        PRECISION_FACTURA_COMENTARIO,
        MAYOR_VALORACION_COMENTARIO,
        COMENTARIOS_ADICIONALES,
        REGION,
        GERENCIA_RESPONSABLE,
        UNIDAD_NEGOCIOS,
        SEGMENTO,
        SEGMENTO_2,
        MERCADO,
        RRVV,
        PSSR,
        NRO_ENCUESTAS,
        CAST(Indice_lealtad AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        TIPO_RAZON_SOCIAL,
        RAZON_SOCIAL_PARENT,
        ATENDIDO_POR,
        MARCA,
        LINEA,
        (concat(SUBSTRING(CAST(MES_ENCUESTA AS STRING), 1, 10))),
        MOTIVO_INSATISFACCION,
        OPORTUNIDAD_MEJORA,
        SUGERENCIA_MEJORA,

    FROM `pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_Motivos_Rep`;


---------- BD_Motivos_Serv ----------

INSERT INTO `pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2` 
    (
    Domain,
    CompanyID,
    CompanyDescription,
    BranchOfficeID,
    BranchOfficeDescription,
    SalesOfficeDescription,
    OperationPlace,
    SurveyDate,
    SurveyEndDate,
    CustomerID,
    CustomerIDDBS,
    CustomerName,
    ModelDescription,
    SerialNumber,
    SurveyContactName,
    SurveyPerson,
    WorkOrderNumber,
    OpeningDate,
    InvoiceDate,
    TransactionDate,
    LastJobDate,
    WorkOrderClosingDate,
    InvoiceID,
    ServiceType,
    CSAType,
    WorkshopGroup,
    WorkOrderPrefix,
    CC_CN,
    WorkOrderPositionType,
    SatisfactionEvaluation,
    BuybackEvaluation,
    RecommendationEvaluation,
    EaseDoingBusinessEvaluation,
    AvailabilityEvaluation,
    AnswerEvaluation,
    CommunicationEvaluation,
    PreparationEvaluation,
    DurationEvaluation,
    TangibleInvoiceEvaluation,
    QualityEvaluation,
    InvoicePunctualityEvaluation,
    InvoiceAccuracyEvaluation,
    SatisfactionComment,
    BuybackComment,
    RecommendationComment,
    EaseDoingBusinessComment,
    AvailabilityComment,
    AnswerComment,
    CommunicationComment,
    PreparationComment,
    DurationComment,
    TangibleInvoiceComment,
    QualityComment,
    InvoicePunctualityComment,
    InvoiceAccuracyComment,
    HigherRatingComment,
    AdditionalComment,
    RegionDescription,
    ResponsibleManagement,
    SalesRepGroupDescription,
    CustomerSegmentDescription,
    AditionalCustomerSegmentDescription,
    CustomerMarketDescription,
    RRVV,
    PSSR,
    SurveyCounter,
    LoyaltyIndex,
    NetLoyaltyScoreDescription,
    NetLoyaltyScore,
    CustomerType,
    ParentCustomerName,
    AttendedBy,
    BrandDescription,
    LineDescription,
    CSAPlanType,
    UniqueID,
    ReasonDissatisfaction,
    OpportunityImprovement,
    Suggestion
    ) 
    SELECT
        'SERVICE',
            CASE
            WHEN Organizacion = 'Ferreyros' THEN '2000'
            ELSE NULL
        END,
        Organizacion,
        N_Sucursal,
        Sucursal,
        Oficina,
        Lugar_Operacion,
        Mes_Encuesta,
        Fecha_finalizacion_encuesta,
        No_cliente,
        No_cliente,
        Nombre_cliente,
        Modelo,
        Numero_Serie,
        Contacto_con_cliente,
        Persona_contesto_encuesta,
        N_Orden_Trabajo,
        Fecha_apertura,
        Fecha_factura,
        Fecha_transaccion,
        Ultimo_trabajo,
        Cierre_orden_trabajo,
        N_factura,
        Tipo_servicio,
        Tipo_CSA,
        Agrupacion_Talleres,
        Prefijo_OT,
        CC_CN,
        Tipo_cargo_OT,
        Satisfaccion_general,
        Recompra,
        Recomendacion,
        Facilidad_para_hacer_negocios,
        Disponibilidad,
        Respuesta,
        Comunicacion,
        Preparacion,
        Duracion,
        Tangibles_Factura,
        Calidad,
        Puntualidad_factura,
        Precision_factura,
        Satisfaccion_General_Coms,
        Recompra_Coms,
        Recomendacion_Coms,
        Facilidad_para_negocios_Coms,
        Disponibilidad_Fiabilidad_Coms,
        Respuesta_Coms,
        Comunicacion_Coms,
        Preparacion_Coms,
        Duracion_Coms,
        Tangibles_Factura_Coms,
        Calidad_Coms,
        Puntualidad_factura_Coms,
        Precision_factura_Coms,
        Mayor_Valoracion_Coms,
        Comentarios_Adicionales,
        Region,
        Gerencia_Responsable,
        Unidad_negocios,
        Segmento,
        Segmento_2,
        Mercado,
        RRVV,
        PSSR,
        Nro_Encuestas,
        CAST(Indice_lealtad AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        Tipo_razon_social,
        Razon_social_Parent,
        Atendido_por,
        Marca,
        LINEA,
        Tipo_CSA,
        Identificador_Unico,
        Motivo_insatisfaccion,
        Oportunidad_mejora,
        Sugerencia_mejora,
    FROM `pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_Motivos_Serv`;






---------------------- CARGA SQL ----------------------------


---------- BD_MOTIVOS_PRIME_SQL ----------

insert into pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2
        (
        Domain,
        CompanyID,
        CompanyDescription,
        BranchOfficeID,
        BranchOfficeDescription,
        SalesOfficeDescription,
        SurveyDate,
        SurveyEndDate,
        CustomerID,
        CustomerIDDBS,
        CustomerName,
        ModelDescription,
        FamilyDescription,
        SerialNumber,
        AssignmentReport,
        SurveyContactName,
        SurveyContactJobPosition,
        SurveyContactPhoneNumber,
        SurveyContactEmail,
        SatisfactionEvaluation,
        BuybackEvaluation,
        RecommendationEvaluation,
        AttentionEvaluation,
        ConfigurationEvaluation,
        PerformanceEvaluation,
        PhysicalDeliveryEvaluation,
        TechnicalDeliveryEvaluation,
        SatisfactionComment,
        BuybackComment,
        RecommendationComment,
        AttentionComment,
        ConfigurationComment,
        PerformanceComment,
        PhysicalDeliveryComment,
        TechnicalDeliveryComment,
        HigherRatingComment,
        AdditionalComment,
        RegionDescription,
        ResponsibleManagement,
        SalesRepGroupDescription,
        CustomerSegmentDescription,
        AditionalCustomerSegmentDescription,
        CustomerMarketDescription,
        RRVV,
        PSSR,
        SurveyCounter,
        LoyaltyIndex,
        NetLoyaltyScoreDescription,
        NetLoyaltyScore,
        ExecutedBy,
        CustomerType,
        ParentCustomerName,
        AttendedBy,
        BrandDescription,
        LineDescription,
        Period,
        UniqueID,
        ReasonDissatisfaction,
        OpportunityImprovement,
        Suggestion
        )
        SELECT
        'PRIME',
        CASE
        WHEN ORGANIZACION = 'Ferreyros' THEN '2000'
            ELSE NULL
        END,
        ORGANIZACION,
        NRO_SUCURSAL,
        SUCURSAL,
        OFICINA,
        MES_ENCUESTA,
        FECHA_DE_FINALIZACION_DE_LA_ENCUESTA,
        CODIGO_DE_CLIENTE,
        CODIGO_DE_CLIENTE,
        NOMBRE_DEL_CLIENTE,
        IND_MODELO,
        FAMILIADEPRODUCTOS,
        SERIE,
        REPORTE_DE_ASIGNACION,
        CONTACTO_PARA_ENCUESTA,
        CARGO,
        TELEFONO,
        CORREO_ELECTRONICO,
        SATISFACCION,
        RECOMPRA,
        RECOMENDACION,
        ATENCION,
        CONFIGURACION,
        DESEMPENIO,
        ENTREGA_FISICA,
        ENTREGA_TECNICA,
        COMENTARIO_SATISFACCION,
        COMENTARIO_RECOMPRA,
        COMENTARIO_RECOMENDACION,
        COMENTARIO_ATENCION,
        COMENTARIO_CONFIGURACION,
        COMENTARIO_DESEMPENIO,
        COMENTARIO_ENTREGA_FISICA,
        COMENTARIO_ENTREGA_TECNICA,
        MAYOR_VALORACION,
        COMENTARIO_ADICIONAL,
        REGION,
        GERENCIA_RESPONSABLE,
        UNIDAD_DE_NEGOCIO,
        SEGMENTO,
        SEGMENTO_2,
        MERCADO,
        RRVV,
        PSSR,
        NRO_ENCUESTAS,
        CAST(INDICE_DE_LEALTAD AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        EJECUTADA_POR,
        TIPO_DE_RAZON_SOCIAL,
        RAZON_SOCIAL_PARENT,
        ATENDIDO_POR,
        MARCA,
        LINEA,
        PERIODO_CARGA,
        identificador_unico,
        MOTIVOS_DE_INSATISFACCION,
        OPORTUNIDAD_DE_MEJORA,
        SUGERENCIA,
        FROM pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_MOTIVOS_PRIME_SQL 


---------- BD_MOTIVOS_REN_SQL ----------

insert into `pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2`
        (
        Domain,
        CompanyID,
        CompanyDescription,
        BranchOfficeID,
        BranchOfficeDescription,
        SalesOfficeDescription,
        SurveyDate,
        SurveyEndDate,
        CustomerID,
        CustomerIDDBS,
        CustomerName,
        CustomerPhomeNumber,
        ComponentCode,
        SerialNumber,
        SurveyContactName,
        SurveyContactPhoneNumber,
        SurveyContactEmail,
        SurveyPerson,
        SurveyPersonNumber,
        SatisfactionEvaluation,
        BuybackEvaluation,
        RecommendationEvaluation,
        EaseDoingBusinessEvaluation,
        AvailabilityEvaluation,
        AnswerEvaluation,
        CommunicationEvaluation,
        PreparationEvaluation,
        DurationEvaluation,
        QualityEvaluation,
        InvoicePunctualityEvaluation,
        InvoiceAccuracyEvaluation,
        SatisfactionComment,
        BuybackComment,
        RecommendationComment,
        EaseDoingBusinessComment,
        AvailabilityComment,
        AnswerComment,
        CommunicationComment,
        PreparationComment,
        DurationComment,
        QualityComment,
        InvoicePunctualityComment,
        InvoiceAccuracyComment,
        HigherRatingComment,
        AdditionalComment,
        AudioFile,
        RegionDescription,
        ResponsibleManagement,
        SalesRepGroupDescription,
        CustomerSegmentDescription,
        AditionalCustomerSegmentDescription,
        CustomerMarketDescription,
        RRVV,
        PSSR,
        SurveyCounter,
        LoyaltyIndex,
        NetLoyaltyScoreDescription,
        NetLoyaltyScore,
        CustomerType,
        ParentCustomerName,
        AttendedBy,
        BrandDescription,
        LineDescription,
        Period,
        ReasonDissatisfaction,
        OpportunityImprovement,
        Suggestion
        )
        SELECT
        'RENTAL',
        CASE
        WHEN ORGANIZACION = 'Ferreyros' THEN '2000'
            ELSE NULL
        END,
        ORGANIZACION,
        NRO_SUCURSAL,
        SUCURSAL,
        OFICINA,
        MES_ENCUESTA,
        FECHA_FINALIZACION_LA_ENCUESTA,
        NUMERO_CLIENTE,
        NUMERO_CLIENTE,
        NOMBRE_CLIENTE,
        NUMERO_DEL_CLIENTE,
        CODIGO_COMPONENTE,
        SERIE,
        CONTACTO_CLIENTE,
        TELEFONO_CONTACTO,
        CORREO_CONTACTO,
        PERSONA_QUE_CONTESTO_LA_ENCUESTA,
        TELEFONO,
        SATISFACCION_GENERAL,
        RECOMPRA,
        RECOMENDACION,
        FACILIDAD_PARA_EL_TRAMITE,
        DISPONIBILIDAD,
        RESPUESTA,
        COMUNICACION,
        PREPARACION,
        DURACION,
        CALIDAD,
        PUNTUALIDAD_LA_FACTURA,
        PRECISION_LA_FACTURA,
        SATISFACCION_GENERAL_COMS,
        RECOMPRA_COMS,
        RECOMENDACION_COMS,
        FACILIDAD_PARA_EL_TRAMITE_COMS,
        DISPONIBILIDAD_Y_FIABILIDAD_COMS,
        RESPUESTA_COMS,
        COMUNICACION_COMS,
        PREPARACION_COMS,
        DURACION_COMS,
        CALIDAD_COMS,
        PUNTUALIDAD_FACTURA_COMS,
        PRECISION_FACTURA_COMS,
        MAYOR_VALORACION_COMS,
        COMENTARIOS_ADICIONALES,
        ARCHIVO_AUDIO,
        REGION,
        GERENCIA_RESPONSABLE,
        UNIDAD_NEGOCIO,
        SEGMENTO,
        SEGMENTO_2,
        MERCADO,
        RRVV,
        PSSR,
        NRO_ENCUESTAS,
        CAST(INDICE_LEALTAD AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        TIPO_RAZON_SOCIAL,
        RAZON_SOCIAL_PARENT,
        ATENDIDO_POR,
        MARCA,
        LINEA,
        PERIODO_CARGA,
        MOTIVO_INSATISFACCION,
        OPORTUNIDAD_MEJORA,
        SUGERENCIA_MEJORA
        FROM `pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_MOTIVOS_REN_SQL`


---------- BD_MOTIVOS_REP_SQL ----------

insert into `pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2`
        (
        Domain,
        CompanyID,
        CompanyDescription,
        SurveyType,
        BranchOfficeID,
        BranchOfficeDescription,
        SalesOfficeDescription,
        SurveyDate,
        SurveyEndDate,
        CustomerID,
        CustomerIDDBS,
        CustomerName,
        InvoiceAmount,
        ReferenceDocument,
        ComponentCode,
        SurveyContactName,
        SurveyContactPhoneNumber,
        SurveyContactEmail,
        SurveyPerson,
        SurveyPersonNumber,
        SatisfactionEvaluation,
        BuybackEvaluation,
        RecommendationEvaluation,
        EaseDoingBusinessEvaluation,
        AvailabilityEvaluation,
        AnswerEvaluation,
        CommunicationEvaluation,
        PreparationEvaluation,
        DurationEvaluation,
        QualityEvaluation,
        InvoicePunctualityEvaluation,
        InvoiceAccuracyEvaluation,
        SatisfactionComment,
        BuybackComment,
        RecommendationComment,
        EaseDoingBusinessComment,
        AvailabilityComment,
        AnswerComment,
        CommunicationComment,
        PreparationComment,
        DurationComment,
        QualityComment,
        InvoicePunctualityComment,
        InvoiceAccuracyComment,
        HigherRatingComment,
        AdditionalComment,
        RegionDescription,
        ResponsibleManagement,
        SalesRepGroupDescription,
        CustomerSegmentDescription,
        AditionalCustomerSegmentDescription,
        CustomerMarketDescription,
        RRVV,
        PSSR,
        SurveyCounter,
        LoyaltyIndex,
        NetLoyaltyScoreDescription,
        NetLoyaltyScore,
        CustomerType,
        ParentCustomerName,
        AttendedBy,
        BrandDescription,
        LineDescription,
        Period,
        ReasonDissatisfaction,
        OpportunityImprovement,
        Suggestion
        )
        SELECT
        'PARTS',
        CASE
        WHEN ORGANIZACION = 'Ferreyros' THEN '2000'
            ELSE NULL
        END,
        ORGANIZACION,
        TIPO_ENCUESTA,
        N_SUCURSAL,
        SUCURSAL,
        OFICINA,
        MES_ENCUESTA,
        FECHA_FINALIZACION_LA_ENCUESTA,
        NUMERO_CLIENTE,
        NUMERO_CLIENTE,
        NOMBRE_CLIENTE,
        MONTO_FACTURADO,
        DOCUMENTO_REFERENCIA,
        CODIGO_COMPONENTE,
        CONTACTO_CLIENTE,
        TELEFONO_CONTACTO,
        CORREO_CONTACTO,
        PERSONA_QUE_RESPONDIO_LA_ENCUESTA,
        TELEFONO,
        SATISFACCION_GENERAL,
        RECOMPRA,
        RECOMENDACION,
        FACILIDAD_PARA_EL_TRAMITE,
        DISPONIBILIDAD_CONOCIMIENTO_VENDEDOR,
        RESPUESTA,
        COMUNICACION,
        PREPARACION_STOCK,
        DURACION,
        CALIDAD,
        PUNTUALIDAD_DE_FACTURA,
        PRECISION_DE_FACTURA,
        SATISFACCION_GENERAL_COMENTARIO,
        RECOMPRA_COMENTARIO,
        RECOMENDACION_COMENTARIO,
        FACILIDAD_PARA_EL_TRAMITE_COMENTARIO,
        DISPONIBILIDAD_Y_FIABILIDAD_COMENTARIO,
        RESPUESTA_COMENTARIO,
        COMUNICACION_COMENTARIO,
        PREPARACION_COMS,
        DURACION_COMENTARIO,
        CALIDAD_COMENTARIO,
        PUNTUALIDAD_DE_FACTURA_COMENTARIO,
        PRECISION_DE_FACTURA_COMENTARIO,
        MAYOR_VALORACION_COMENTARIO,
        COMENTARIOS_ADICIONALES,
        REGION,
        GERENCIA_RESPONSABLE,
        UNIDAD_NEGOCIOS,
        SEGMENTO,
        SEGMENTO_2,
        MERCADO,
        RRVV,
        PSSR,
        NRO_ENCUESTAS,
        CAST(INDICE_LEALTAD AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        TIPO_RAZON_SOCIAL,
        RAZON_SOCIAL_PARENT,
        ATENDIDO_POR,
        MARCA,
        LINEA,
        PERIODO_CARGA,
        MOTIVO_INSATISFACCION,
        OPORTUNIDAD_MEJORA,
        SUGERENCIA_MEJORA
        FROM `pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_MOTIVOS_REP_SQL`


---------- BD_MOTIVOS_SERV_SQL ----------

insert into `pe-fesa-datalake-prd01.processed_common_data_model.ReasonDissatisfactionV2`
        (
        Domain,
        CompanyID,
        CompanyDescription,
        BranchOfficeID,
        BranchOfficeDescription,
        SalesOfficeDescription,
        SurveyDate,
        SurveyEndDate,
        CustomerID,
        CustomerIDDBS,
        CustomerName,
        SurveyContactName,
        SurveyPerson,
        SatisfactionEvaluation,
        BuybackEvaluation,
        RecommendationEvaluation,
        EaseDoingBusinessEvaluation,
        AvailabilityEvaluation,
        AnswerEvaluation,
        CommunicationEvaluation,
        PreparationEvaluation,
        DurationEvaluation,
        QualityEvaluation,
        InvoicePunctualityEvaluation,
        InvoiceAccuracyEvaluation,
        SatisfactionComment,
        BuybackComment,
        RecommendationComment,
        EaseDoingBusinessComment,
        AvailabilityComment,
        AnswerComment,
        CommunicationComment,
        PreparationComment,
        DurationComment,
        QualityComment,
        InvoicePunctualityComment,
        InvoiceAccuracyComment,
        HigherRatingComment,
        AdditionalComment,
        RegionDescription,
        ResponsibleManagement,
        SalesRepGroupDescription,
        CustomerSegmentDescription,
        AditionalCustomerSegmentDescription,
        CustomerMarketDescription,
        RRVV,
        PSSR,
        SurveyCounter,
        LoyaltyIndex,
        NetLoyaltyScoreDescription,
        NetLoyaltyScore,
        CustomerType,
        ParentCustomerName,
        AttendedBy,
        BrandDescription,
        LineDescription,
        Period,
        ReasonDissatisfaction,
        OpportunityImprovement,
        Suggestion
        )
        SELECT
        'SERVICE',
        CASE
        WHEN ORGANIZACION = 'Ferreyros' THEN '2000'
            ELSE NULL
        END,
        ORGANIZACION,
        N_SUCURSAL,
        SUCURSAL,
        OFICINA,
        MES_ENCUESTA,
        FECHA_FINALIZACION_LA_ENCUESTA,
        NRO_CLIENTE,
        NRO_CLIENTE,
        NOMBRE_CLIENTE,
        CONTACTO_CON_EL_CLIENTE,
        PERSONA_QUE_CONTESTO_LA_ENCUESTA,
        SATISFACCION_GENERAL,
        RECOMPRA,
        RECOMENDACION,
        FACILIDAD_PARA_HACER_NEGOCIOS,
        DISPONIBILIDAD,
        RESPUESTA,
        COMUNICACION,
        PREPARACION,
        DURACION,
        CALIDAD,
        PUNTUALIDAD_LA_FACTURA,
        PRECISION_LA_FACTURA,
        SATISFACCION_GENERAL_COMS,
        RECOMPRA_COMS,
        RECOMENDACION_COMS,
        FACILIDAD_PARA_HACER_NEGOCIOS_COMS,
        DISPONIBILIDAD_Y_FIABILIDAD_COMS,
        RESPUESTA_COMS,
        COMUNICACION_COMS,
        PREPARACION_COMS,
        DURACION_COMS,
        CALIDAD_COMS,
        PUNTUALIDAD_LA_FACTURA_COMS,
        PRECISION_LA_FACTURA_COMS,
        MAYOR_VALORACION_COMS,
        COMENTARIOS_ADICIONALES,
        REGION,
        GERENCIA_RESPONSABLE,
        UNIDAD_NEGOCIOS,
        SEGMENTO,
        SEGMENTO_2,
        MERCADO,
        RRVV,
        PSSR,
        NRO_ENCUESTAS,
        CAST(INDICE_LEALTAD AS NUMERIC),
        NLS2,
        CAST(NLS AS NUMERIC),
        TIPO_RAZON_SOCIAL,
        RAZON_SOCIAL_PARENT,
        ATENDIDO_POR,
        MARCA,
        LINEA,
        PERIODO_CARGA,
        MOTIVO_INSATISFACCION,
        OPORTUNIDAD_MEJORA,
        SUGERENCIA_MEJORA
        FROM `pe-fesa-datalake-prd01.processed_fuentes_diversas.BD_MOTIVOS_SERV_SQL`


